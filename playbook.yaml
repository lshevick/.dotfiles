- name: update and get
  hosts: localhost 
  become: true
  tasks:
    - name: Install packages with apt
      become: yes
      ansible.builtin.apt:
        name:
          - git
          - neofetch
          - fish
          - stow
          - fzf
          - vim
          - nodejs
          - curl
        state: present

    - name: get omf 
      ansible.builtin.git:
        repo: 'https://github.com/oh-my-fish/oh-my-fish.git'
        dest: "{{lookup('env', 'HOME')}}/.local/share/git/oh-my-fish"

    - name: install omf
      become: true
      ansible.builtin.shell:
        cmd: "bin/install --offline --noninteractive --yes"
        executable: "/usr/bin/fish"
        chdir: "{{lookup('env', 'HOME')}}/local/share/git/oh-my-fish"

    - name: clone dotfiles
      ansible.builtin.git:
        repo: https://github.com/lshevick/.dotfiles.git
        dest: "{{lookup('env', 'HOME')}}/.dotfiles"
        clone: true
        depth: 1

    - name: rm default bashrc 
      ansible.builtin.shell:
        chdir: "{{lookup('env', 'HOME')}}"
        cmd: "rm .bashrc"
          
    - name: run stow 
      ansible.builtin.shell:
        chdir: "{{lookup('env', 'HOME')}}/.dotfiles"
        cmd: "stow ."



